(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{zrcO:function(e,t,i){"use strict";i.r(t),i.d(t,"UsersModule",(function(){return V}));var r=i("3Pt+"),s=i("ofXK"),o=i("tyNb"),n=i("fXoL");let c=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Ib({type:e,selectors:[["ng-component"]],decls:3,vars:0,consts:[[1,"p-4"],[1,"container",2,"min-width","1200px"]],template:function(e,t){1&e&&(n.Tb(0,"div",0),n.Tb(1,"div",1),n.Pb(2,"router-outlet"),n.Sb(),n.Sb())},directives:[o.g],encapsulation:2}),e})();var b=i("SxV6"),a=i("XNiG"),d=i("J9tS"),l=i("njyG");function u(e,t){1&e&&n.Pb(0,"span",17)}function f(e,t){1&e&&(n.Tb(0,"span"),n.Gc(1,"Delete"),n.Sb())}function m(e,t){if(1&e){const e=n.Ub();n.Tb(0,"tr"),n.Tb(1,"td"),n.Gc(2),n.Sb(),n.Tb(3,"td"),n.Gc(4),n.Sb(),n.Tb(5,"td"),n.Gc(6),n.Sb(),n.Tb(7,"td"),n.Tb(8,"a",8),n.fc("click",(function(){n.xc(e);const i=t.$implicit;return n.jc().navigateToProfile(i.id)})),n.Gc(9),n.Sb(),n.Sb(),n.Tb(10,"td"),n.Gc(11),n.Sb(),n.Tb(12,"td"),n.Gc(13),n.Sb(),n.Tb(14,"td"),n.Gc(15),n.Sb(),n.Tb(16,"td"),n.Tb(17,"div",9),n.Tb(18,"a",10),n.Gc(19,"Edit"),n.Sb(),n.Tb(20,"button",11),n.fc("click",(function(){n.xc(e);const i=t.$implicit;return n.jc().deleteUser(i.id)})),n.Ec(21,u,1,0,"span",12),n.Ec(22,f,2,0,"span",13),n.Sb(),n.Tb(23,"button",14),n.Gc(24," Email "),n.Sb(),n.Tb(25,"div",15),n.Tb(26,"button",16),n.fc("click",(function(){n.xc(e);const i=t.$implicit;return n.jc().sendEmail(i.id,"IN_USE")})),n.Gc(27,"IN_USE"),n.Sb(),n.Tb(28,"button",16),n.fc("click",(function(){n.xc(e);const i=t.$implicit;return n.jc().sendEmail(i.id,"ORDERED")})),n.Gc(29,"ORDERED"),n.Sb(),n.Tb(30,"button",16),n.fc("click",(function(){n.xc(e);const i=t.$implicit;return n.jc().sendEmail(i.id,"IN_LIBRARY")})),n.Gc(31,"IN_LIBRARY"),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()}if(2&e){const e=t.$implicit;n.Bb(2),n.Hc(e.id),n.Bb(2),n.Hc(e.firstName),n.Bb(2),n.Hc(e.lastName),n.Bb(3),n.Ic(" ",e.email," "),n.Bb(2),n.Hc(e.phone),n.Bb(2),n.Hc(e.age),n.Bb(2),n.Hc(e.role),n.Bb(3),n.qc("routerLink","edit/",e.id,""),n.Bb(3),n.oc("ngIf",e.isDeleting),n.Bb(1),n.oc("ngIf",!e.isDeleting)}}let p=(()=>{class e{constructor(e,t,i){this.accountService=e,this.router=t,this.activatedRoute=i,this.dtOptions={},this.users=[],this.dtTrigger=new a.a}ngOnInit(){this.dtOptions={pagingType:"full_numbers",pageLength:20},this.accountService.getAll().pipe(Object(b.a)()).subscribe(e=>{this.users=e,this.dtTrigger.next()}),this.userRole=this.accountService.getRole()}ngOnDestroy(){this.dtTrigger.unsubscribe()}deleteUser(e){this.users.find(t=>t.id===e),this.accountService.delete(e).pipe(Object(b.a)()).subscribe(()=>{this.users=this.users.filter(t=>t.id!==e)})}navigateToProfile(e){this.router.navigate(["/profile/"+e],{relativeTo:this.activatedRoute})}sendEmail(e,t){this.accountService.sendEmail(e,t)}}return e.\u0275fac=function(t){return new(t||e)(n.Ob(d.a),n.Ob(o.c),n.Ob(o.a))},e.\u0275cmp=n.Ib({type:e,selectors:[["ng-component"]],decls:24,vars:3,consts:[["routerLink","add",1,"btn","btn-sm","btn-success","mb-2"],["datatable","",1,"table","table-striped",3,"dtOptions","dtTrigger"],[2,"width","4%"],[2,"width","10%"],[2,"width","16%"],[2,"width","6%"],[2,"width","22%"],[4,"ngFor","ngForOf"],[3,"click"],[1,"dropdown",2,"width","100%"],[1,"btn","btn-sm","btn-primary","mr-1",3,"routerLink"],[1,"btn","btn-sm","btn-danger","btn-delete-user",3,"click"],["class","spinner-border spinner-border-sm",4,"ngIf"],[4,"ngIf"],["type","button","id","dropdownMenuButton","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-secondary","dropdown-toggle","ml-1",2,"width","40%","font-size",".875rem","padding","0.25rem 0.5rem"],["aria-labelledby","dropdownMenuButton",1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"spinner-border","spinner-border-sm"]],template:function(e,t){1&e&&(n.Tb(0,"h1"),n.Gc(1,"Users"),n.Sb(),n.Tb(2,"a",0),n.Gc(3,"Add User"),n.Sb(),n.Tb(4,"table",1),n.Tb(5,"thead"),n.Tb(6,"tr"),n.Tb(7,"th",2),n.Gc(8,"ID"),n.Sb(),n.Tb(9,"th",3),n.Gc(10,"First name"),n.Sb(),n.Tb(11,"th",3),n.Gc(12,"Last name"),n.Sb(),n.Tb(13,"th",4),n.Gc(14,"Email"),n.Sb(),n.Tb(15,"th",4),n.Gc(16,"Telephone"),n.Sb(),n.Tb(17,"th",4),n.Gc(18,"Age"),n.Sb(),n.Tb(19,"th",5),n.Gc(20,"Role"),n.Sb(),n.Pb(21,"th",6),n.Sb(),n.Sb(),n.Tb(22,"tbody"),n.Ec(23,m,32,10,"tr",7),n.Sb(),n.Sb()),2&e&&(n.Bb(4),n.oc("dtOptions",t.dtOptions)("dtTrigger",t.dtTrigger),n.Bb(19),n.oc("ngForOf",t.users))},directives:[o.e,l.a,s.j,s.k],encapsulation:2}),e})();function h(e,t){1&e&&(n.Tb(0,"h1"),n.Gc(1,"Add User"),n.Sb())}function g(e,t){1&e&&(n.Tb(0,"h1"),n.Gc(1,"Edit User"),n.Sb())}function S(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"First Name is required"),n.Sb())}function v(e,t){if(1&e&&(n.Tb(0,"div",20),n.Ec(1,S,2,0,"div",0),n.Sb()),2&e){const e=n.jc();n.Bb(1),n.oc("ngIf",e.f.firstName.errors.required)}}function T(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"Last Name is required"),n.Sb())}function G(e,t){if(1&e&&(n.Tb(0,"div",20),n.Ec(1,T,2,0,"div",0),n.Sb()),2&e){const e=n.jc();n.Bb(1),n.oc("ngIf",e.f.lastName.errors.required)}}function B(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"Age is required"),n.Sb())}function I(e,t){if(1&e&&(n.Tb(0,"div",20),n.Ec(1,B,2,0,"div",0),n.Sb()),2&e){const e=n.jc();n.Bb(1),n.oc("ngIf",e.f.age.errors.required)}}function E(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"Phone is required"),n.Sb())}function w(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"Phone must have 9 digits"),n.Sb())}function N(e,t){if(1&e&&(n.Tb(0,"div",20),n.Ec(1,E,2,0,"div",0),n.Ec(2,w,2,0,"div",0),n.Sb()),2&e){const e=n.jc();n.Bb(1),n.oc("ngIf",e.f.lastName.errors.required),n.Bb(1),n.oc("ngIf",e.f.phone.errors.pattern)}}function y(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"Email is required"),n.Sb())}function O(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"Email is not valid"),n.Sb())}function C(e,t){if(1&e&&(n.Tb(0,"div",20),n.Ec(1,y,2,0,"div",0),n.Ec(2,O,2,0,"div",0),n.Sb()),2&e){const e=n.jc();n.Bb(1),n.oc("ngIf",e.f.email.errors.required),n.Bb(1),n.oc("ngIf",e.f.email.errors.email)}}const j=function(e){return{"is-invalid":e}};function k(e,t){if(1&e&&(n.Tb(0,"div",3),n.Tb(1,"label",21),n.Gc(2," Role "),n.Sb(),n.Tb(3,"select",22),n.Tb(4,"option",23),n.Gc(5,"User"),n.Sb(),n.Tb(6,"option",24),n.Gc(7,"Admin"),n.Sb(),n.Sb(),n.Sb()),2&e){const e=n.jc();n.Bb(3),n.oc("ngClass",n.sc(1,j,e.submitted&&e.f.role.errors))}}function q(e,t){1&e&&(n.Tb(0,"em"),n.Gc(1,"(Leave blank to keep the same password)"),n.Sb())}function A(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"Password is required"),n.Sb())}function P(e,t){1&e&&(n.Tb(0,"div"),n.Gc(1,"Password must be at least 6 characters"),n.Sb())}function U(e,t){if(1&e&&(n.Tb(0,"div",20),n.Ec(1,A,2,0,"div",0),n.Ec(2,P,2,0,"div",0),n.Sb()),2&e){const e=n.jc(2);n.Bb(1),n.oc("ngIf",e.f.password.errors.required),n.Bb(1),n.oc("ngIf",e.f.password.errors.minlength)}}function M(e,t){if(1&e&&(n.Tb(0,"div",3),n.Tb(1,"label",25),n.Gc(2," Password "),n.Ec(3,q,2,0,"em",0),n.Sb(),n.Pb(4,"input",26),n.Ec(5,U,3,2,"div",6),n.Sb()),2&e){const e=n.jc();n.Bb(3),n.oc("ngIf",!e.isAddMode),n.Bb(1),n.oc("ngClass",n.sc(3,j,e.submitted&&e.f.password.errors)),n.Bb(1),n.oc("ngIf",e.submitted&&e.f.password.errors)}}function R(e,t){1&e&&n.Pb(0,"span",27)}let x=(()=>{class e{constructor(e,t,i,r,s){this.formBuilder=e,this.route=t,this.router=i,this.accountService=r,this.alertService=s,this.loading=!1,this.submitted=!1}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id;const e=[r.o.minLength(6)];this.isAddMode&&e.push(r.o.required),this.form=this.formBuilder.group({firstName:["",r.o.required],lastName:["",r.o.required],email:["",[r.o.required,r.o.email]],age:["",r.o.required],phone:["",[r.o.required,r.o.pattern("^((\\+91-?)|0)?[0-9]{9}$")]],password:["",e],role:["",r.o.required]}),this.isAddMode||this.accountService.getById(this.id).pipe(Object(b.a)()).subscribe(e=>{this.f.firstName.setValue(e.firstName),this.f.lastName.setValue(e.lastName),this.f.age.setValue(e.age),this.f.phone.setValue(e.phone),this.f.email.setValue(e.email),this.f.password.setValue(e.password),this.f.role.setValue(e.role)})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),this.form.invalid||(this.loading=!0,this.isAddMode?this.createUser():this.updateUser())}createUser(){this.accountService.register(this.form.value).pipe(Object(b.a)()).subscribe(e=>{this.alertService.success("User added successfully",{keepAfterRouteChange:!0}),this.router.navigate([".",{relativeTo:this.route}])},e=>{this.alertService.error(e.error.errorMessage),this.loading=!1})}updateUser(){this.accountService.update(this.id,this.form.value).pipe(Object(b.a)()).subscribe(e=>{this.alertService.success("Update successful",{keepAfterRouteChange:!0}),this.router.navigate(["..",{relativeTo:this.route}])},e=>{this.alertService.error(e.error.errorMessage),this.loading=!1})}}return e.\u0275fac=function(t){return new(t||e)(n.Ob(r.b),n.Ob(o.a),n.Ob(o.c),n.Ob(d.a),n.Ob(d.b))},e.\u0275cmp=n.Ib({type:e,selectors:[["ng-component"]],decls:39,vars:27,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-row"],[1,"form-group","col"],["for","firstName"],["type","text","required","","formControlName","firstName",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","lastName"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],["for","age"],["type","text","formControlName","age",1,"form-control",3,"ngClass"],["for","phone"],["type","text","formControlName","phone",1,"form-control",3,"ngClass"],["for","email"],["type","text","formControlName","email",1,"form-control",3,"ngClass"],["class","form-group col",4,"ngIf"],[1,"form-group"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","/users",1,"btn","btn-link"],[1,"invalid-feedback"],["for","role"],["type","text","name","role","formControlName","role",1,"form-control",3,"ngClass"],["label","User","value","USER"],["label","Admin","value","ADMIN","selected",""],["for","password"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(e,t){1&e&&(n.Ec(0,h,2,0,"h1",0),n.Ec(1,g,2,0,"h1",0),n.Tb(2,"form",1),n.fc("ngSubmit",(function(){return t.onSubmit()})),n.Tb(3,"div",2),n.Tb(4,"div",3),n.Tb(5,"label",4),n.Gc(6,"First Name"),n.Sb(),n.Pb(7,"input",5),n.Ec(8,v,2,1,"div",6),n.Sb(),n.Tb(9,"div",3),n.Tb(10,"label",7),n.Gc(11,"Last Name"),n.Sb(),n.Pb(12,"input",8),n.Ec(13,G,2,1,"div",6),n.Sb(),n.Sb(),n.Tb(14,"div",2),n.Tb(15,"div",3),n.Tb(16,"label",9),n.Gc(17,"Age"),n.Sb(),n.Pb(18,"input",10),n.Ec(19,I,2,1,"div",6),n.Sb(),n.Tb(20,"div",3),n.Tb(21,"label",11),n.Gc(22,"Phone"),n.Sb(),n.Pb(23,"input",12),n.Ec(24,N,3,2,"div",6),n.Sb(),n.Sb(),n.Tb(25,"div",2),n.Tb(26,"div",3),n.Tb(27,"label",13),n.Gc(28,"Email"),n.Sb(),n.Pb(29,"input",14),n.Ec(30,C,3,2,"div",6),n.Sb(),n.Ec(31,k,8,3,"div",15),n.Ec(32,M,6,5,"div",15),n.Sb(),n.Tb(33,"div",16),n.Tb(34,"button",17),n.Ec(35,R,1,0,"span",18),n.Gc(36," Save "),n.Sb(),n.Tb(37,"a",19),n.Gc(38,"Cancel"),n.Sb(),n.Sb(),n.Sb()),2&e&&(n.oc("ngIf",t.isAddMode),n.Bb(1),n.oc("ngIf",!t.isAddMode),n.Bb(1),n.oc("formGroup",t.form),n.Bb(5),n.oc("ngClass",n.sc(17,j,t.submitted&&t.f.firstName.errors)),n.Bb(1),n.oc("ngIf",t.submitted&&t.f.firstName.errors),n.Bb(4),n.oc("ngClass",n.sc(19,j,t.submitted&&t.f.lastName.errors)),n.Bb(1),n.oc("ngIf",t.submitted&&t.f.lastName.errors),n.Bb(5),n.oc("ngClass",n.sc(21,j,t.submitted&&t.f.age.errors)),n.Bb(1),n.oc("ngIf",t.submitted&&t.f.age.errors),n.Bb(4),n.oc("ngClass",n.sc(23,j,t.submitted&&t.f.phone.errors)),n.Bb(1),n.oc("ngIf",t.submitted&&t.f.phone.errors),n.Bb(5),n.oc("ngClass",n.sc(25,j,t.submitted&&t.f.email.errors)),n.Bb(1),n.oc("ngIf",t.submitted&&t.f.email.errors),n.Bb(1),n.oc("ngIf",!t.isAddMode),n.Bb(1),n.oc("ngIf",t.isAddMode),n.Bb(2),n.oc("disabled",t.loading),n.Bb(1),n.oc("ngIf",t.loading))},directives:[s.k,r.q,r.i,r.d,r.a,r.m,r.h,r.c,s.i,o.e,r.n,r.j,r.p],encapsulation:2}),e})();const L=[{path:"",component:c,children:[{path:"",component:p},{path:"add",component:x},{path:"edit/:id",component:x}]}];let D=(()=>{class e{}return e.\u0275mod=n.Mb({type:e}),e.\u0275inj=n.Lb({factory:function(t){return new(t||e)},imports:[[o.f.forChild(L)],o.f]}),e})(),V=(()=>{class e{}return e.\u0275mod=n.Mb({type:e}),e.\u0275inj=n.Lb({factory:function(t){return new(t||e)},imports:[[s.b,r.l,D,l.b]]}),e})()}}]);